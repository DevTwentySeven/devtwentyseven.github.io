<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dev Twenty Seven</title>
  <style>
    /* Barra do ticker no topo */
    .ticker-bar {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 32px;
      background-color: #000;
      color: #fff;
      font-family: monospace;
      font-size: 14px;
      display: flex;
      align-items: center;
      overflow: hidden;
      border-bottom: 1px solid #00ff00;
      z-index: 9999;
    }

    /* Movimento cont√≠nuo da direita para esquerda */
    .ticker-move {
      display: inline-flex;
      animation: tickerScroll 35s linear infinite;
    }

    @keyframes tickerScroll {
      from { transform: translateX(100%); }
      to { transform: translateX(-100%); }
    }

    /* Cada token mostrado no ticker */
    .token {
      display: flex;
      align-items: center;
      margin: 0 25px;
      white-space: nowrap;
      text-shadow: 1px 1px 0 #000;
    }

    /* √çcone do token */
    .token img {
      width: 16px;
      height: 16px;
      margin-right: 6px;
      border-radius: 50%;
    }

    /* Espa√ßamento dos textos */
    .token span {
      margin-right: 8px;
    }

    /* Verde se varia√ß√£o positiva */
    .positive {
      color: #00ff00;
    }

    /* Vermelho se varia√ß√£o negativa */
    .negative {
      color: #ff4444;
    }
  </style>
</head>
<body>
  <!-- Barra Ticker -->
  <div class="ticker-bar">
    <div id="ticker" class="ticker-move">
      <!-- Tokens ser√£o injetados via JS -->
    </div>
  </div>

  <div style="margin-top:50px; text-align:center; color:white;">
    Conte√∫do do site...
  </div>

  <script>
    // üîπ Lista fixa de contratos Solana para exibir na watchlist
    const tokensWatchlist = [
      "So11111111111111111111111111111111111111112", // SOL
      "9A2jUbgoDY97fruKHXvDd7eQiq4xvnW3By1BfH1Bwn9Y", // DEEP
      "J3oWJafxg8xmH5vvwBAVX99rmr8b7C9BxjmjaMgCpump", // MAHA
      "AtPNZ3Rwcezea16xkjkxULzCMKpSbS2rVEirVfzrnEa6", // GOLD
      "vtUzXyowSMsNUwiZMLNufySoeW9ehaPAVr7YsYQpump", // MARV
      "FRsV3m924aGpLMuEekoo3JkkMt1oopaM4JY9ki5YLXrp"  // XVM
    ];

    // üîπ Fun√ß√£o para formatar n√∫meros grandes em K, M, B, T
    function formatNumber(num) {
      if (num >= 1e12) return (num / 1e12).toFixed(2) + "T";
      if (num >= 1e9)  return (num / 1e9).toFixed(2) + "B";
      if (num >= 1e6)  return (num / 1e6).toFixed(2) + "M";
      if (num >= 1e3)  return (num / 1e3).toFixed(2) + "K";
      return num.toFixed(2);
    }

    // üîπ Fun√ß√£o para buscar informa√ß√µes do token na API da DexScreener
    async function fetchTokenInfo(address) {
      const url = `https://api.dexscreener.com/latest/dex/tokens/${address}`;
      try {
        const res = await fetch(url);
        const data = await res.json();

        // Se n√£o houver pares, retorna nulo
        if (!data.pairs || data.pairs.length === 0) return null;

        // Seleciona o par principal contra USDC se existir, sen√£o o primeiro dispon√≠vel
        const pair = data.pairs.find(p => p.quoteToken.symbol === "USDC") || data.pairs[0];

        return {
          symbol: pair.baseToken.symbol,
          icon: pair.info?.imageUrl || "",  // Algumas vezes o campo pode n√£o existir
          // Market Cap ‚Üí tenta FDV, se n√£o existir pega MarketCap, se n√£o Liquidez
          marketCap: pair.fdv || pair.marketCap || pair.liquidity?.usd || 0,
          change1h: pair.priceChange?.h1 || 0
        };
      } catch (err) {
        console.error("DexScreener fetch error", err);
        return null;
      }
    }

    // üîπ Fun√ß√£o para construir a barra do ticker
    async function buildTicker() {
      const tickerEl = document.getElementById("ticker");
      tickerEl.innerHTML = "";

      for (const address of tokensWatchlist) {
        const info = await fetchTokenInfo(address);
        if (!info) continue;

        const span = document.createElement("div");
        span.className = "token";

        // Define cor positiva ou negativa para a varia√ß√£o 1h
        const signClass = info.change1h >= 0 ? "positive" : "negative";

        // Monta o HTML de cada token
        span.innerHTML = `
          ${info.icon ? `<img src="${info.icon}" alt="${info.symbol}">` : ""}
          <span>${info.symbol}</span>
          <span>$${formatNumber(info.marketCap)}</span>
          <span class="${signClass}">${info.change1h >= 0 ? "+" : ""}${info.change1h.toFixed(2)}%</span>
        `;
        tickerEl.appendChild(span);
      }
    }

    // üîπ Primeira execu√ß√£o ao carregar a p√°gina
    buildTicker();

    // üîπ Atualiza a cada 1 minuto
    setInterval(buildTicker, 3000);
  </script>
</body>
</html>
